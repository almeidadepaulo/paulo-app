-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB061]'))
DROP VIEW [dbo].[VW_CB061]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB061]
WITH ENCRYPTION
AS
  SELECT
    CB061.CB061_NR_INST,
  	CB061.CB061_CD_FORMAT,
  	CB061.CB061_DS_FORMAT,
  	CB061.CB061_VL_CUSTOP,
  	CB061.CB061_ID_TIPOPG,
  	CASE 
	WHEN CB061.CB061_ID_TIPOPG = 1 THEN 'A4'
	WHEN CB061.CB061_ID_TIPOPG = 2 THEN 'A5'
	WHEN CB061.CB061_ID_TIPOPG = 3 THEN 'A3'
	ELSE 'Carta'
	END CB061_ID_TIPOPG_L,
  	CB061.CB061_NR_PESOPG,
  	CB061.CB061_CD_OPESIS,
  	CB061.CB061_DT_INCSIS,
  	CB061.CB061_DT_ATUSIS,
  	
  	
    CB050.CB050_NR_INST,
  	CB050.CB050_NM_INST,
  	CB050.CB050_NM_INSTR,
  	CB050.CB050_CD_OPESIS,
  	CB050.CB050_DT_INCSIS,
  	CB050.CB050_DT_ATUSIS,
    Cast(CB050.CB050_NR_INST as varchar) +' - '+ CB050.CB050_NM_INST AS CB050_NR_NM_INST
    
  FROM CB061 AS CB061
  
  LEFT OUTER JOIN CB050 AS CB050
  ON CB061.CB061_NR_INST = CB050.CB050_NR_INST -- Teste
  
GO