-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB306]'))
DROP VIEW [dbo].[VW_CB306]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB306]
WITH ENCRYPTION
AS

  SELECT 
  
  CB306.CB306_NR_OPERADOR,
  CB306.CB306_NR_CEDENTE,
  CB306.CB306_CD_COMPSC,
  CB306.CB306_NR_AGENC,
  CB306.CB306_NR_CONTA,
  CB306.CB306_NR_CPFCNPJ,
  CB306.CB306_NR_LANC,
  CB306.CB306_NR_CONTRA,
  CB306.CB306_VL_LANC,
  CB306.CB306_ID_SINAL,
  CB306.CB306_DT_LANC,  
  CB306.CB306_DS_LANC,
  CB306.CB306_CD_HISTOR,
  CB306.CB306_DT_INCSIS,
  CB306.CB306_DT_ATUSIS,
  
  CB307.CB307_NR_OPERADOR,
  CB307.CB307_NR_CEDENTE,
  CB307.CB307_NR_PROD,
  CB307.CB307_NR_TPLANC,
  CB307.CB307_NM_TPLANC,
  CB307.CB307_TP_FINANC,
  CB307.CB307_TP_SINAL,
  CB307.CB307_NR_OPESIS,
  CB307.CB307_DT_INCSIS,
  CB307.CB307_DT_ATUSIS,

  VW_CB260.CB250_NM_BANCO,
  VW_CB260.CB251_NR_DG_AGENC,
  VW_CB260.CB260_NR_CONTA_DG
  
   
  FROM CB306 AS CB306
   
  LEFT OUTER JOIN CB307 AS CB307
  ON  CB307.CB307_NR_OPERADOR = CB306.CB306_NR_OPERADOR
  AND CB307.CB307_NR_CEDENTE  = CB306.CB306_NR_CEDENTE

  INNER JOIN VW_CB260 AS VW_CB260
  ON VW_CB260.CB260_NR_OPERADOR = CB306.CB306_NR_OPERADOR
  AND VW_CB260.CB260_NR_CEDENTE = CB306.CB306_NR_CEDENTE
  AND VW_CB260.CB260_CD_COMPSC = CB306.CB306_CD_COMPSC
  AND VW_CB260.CB260_NR_AGENC = CB306.CB306_NR_AGENC
  AND VW_CB260.CB260_NR_CONTA = CB306.CB306_NR_CONTA
GO