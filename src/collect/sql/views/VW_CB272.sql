-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB272]'))
DROP VIEW [dbo].[VW_CB272]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB272]
WITH ENCRYPTION
AS
 SELECT 
  
  CB272.CB272_CD_COMPSC,
  CB272.CB272_NR_AGENC,
  CB272.CB272_NR_CONTA,
  CB272.CB272_CD_FORMU,
  CB272.CB272_NR_SEQ,
  CB272.CB272_DS_TEXTO,
  CB272.CB272_CD_OPESIS,
  CB272.CB272_DT_INCSIS,
  CB272.CB272_DT_ATUSIS,
  
  -- BANCO
  CB250.CB250_CD_COMPSC,
  CB250.CB250_NM_BANCO,
  
  -- AGENCIA
  CB251.CB251_CD_COMPSC,
  CB251.CB251_NM_AGENC,
  
  -- CONTA
  CB260.CB260_CD_COMPSC,
  CB260.CB260_NR_AGENC,
  CB260.CB260_NM_CEDENT,
  
  -- FORMUL√ÅRIO
  CB270.CB270_CD_COMPSC,
  CB270.CB270_NR_AGENC,
  CB270.CB270_NR_CONTA,
  CB270.CB270_CD_FORMU,
  CB270.CB270_DS_FORMU
  
  
  FROM CB272 AS CB272
  
LEFT OUTER JOIN CB250 AS CB250  -- BANCO
ON     CB250_NR_OPERADOR = CB272_NR_OPERADOR
   AND CB250_NR_CEDENTE  = CB272_NR_CEDENTE
   AND CB250_CD_COMPSC	 = CB272_CD_COMPSC 

 LEFT OUTER JOIN CB251 AS CB251  -- AGENCIA
ON     CB251_NR_OPERADOR = CB272_NR_OPERADOR
   AND CB251_NR_CEDENTE  = CB272_NR_CEDENTE
   AND CB251_CD_COMPSC	 = CB272_CD_COMPSC 
   AND CB251_NR_AGENC	 = CB272_NR_AGENC   

 LEFT OUTER JOIN CB260 AS CB260  -- CONTA
ON     CB260_NR_OPERADOR  = CB272_NR_OPERADOR
   AND CB260_NR_CEDENTE   = CB272_NR_CEDENTE
   AND CB260_CD_COMPSC	  = CB272_CD_COMPSC 
   AND CB260_NR_AGENC	  = CB272_NR_AGENC
   AND CB260_NR_CONTA	  = CB272_NR_CONTA

  LEFT OUTER JOIN CB270 AS CB270  -- FORMULARIO
ON    CB270_NR_OPERADOR     = CB272.CB272_NR_OPERADOR
  AND CB270_NR_CEDENTE      = CB272.CB272_NR_CEDENTE
  AND CB270.CB270_CD_COMPSC	= CB272.CB272_CD_COMPSC 
  AND CB270.CB270_NR_AGENC	= CB272.CB272_NR_AGENC
  AND CB270.CB270_NR_CONTA	= CB272.CB272_NR_CONTA
  AND CB270.CB270_CD_FORMU	= CB272.CB272_CD_FORMU
	
GO