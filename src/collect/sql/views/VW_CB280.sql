-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB280]'))
DROP VIEW [dbo].[VW_CB280]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB280]
WITH ENCRYPTION
AS
 SELECT 
  
  CB280.CB280_CD_COMPSC,
  CB280.CB280_NR_AGENC,
  CB280.CB280_NR_CONTA,
  CB280.CB280_CD_FORMU,
  CB280.CB280_NR_INST,
  CB280.CB280_CD_EMIEMP,
  CB280.CB280_CD_PUBLIC,
  CB280.CB280_CD_FORMAT,
  CB280.CB280_CD_OPESIS,
  CB280.CB280_DT_INCSIS,
  CB280.CB280_DT_ATUSIS,
  
  -- BANCO
  CB250.CB250_CD_COMPSC,
  CB250.CB250_NM_BANCO,
  
  -- AGENCIA
  CB251.CB251_CD_COMPSC,
  CB251.CB251_NM_AGENC,
  
  -- CONTA
  CB260.CB260_CD_COMPSC,
  CB260.CB260_NR_AGENC,
  CB260.CB260_NM_CEDENT,
  
  -- FORMUL√ÅRIO
  CB270.CB270_CD_COMPSC,
  CB270.CB270_NR_AGENC,
  CB270.CB270_NR_CONTA,
  CB270.CB270_CD_FORMU,
  CB270.CB270_DS_FORMU,
  
  CB050.CB050_NM_INST,
  
  CB053.CB053_DS_EMIEMP,
  
  CB060.CB060_DS_PUBLIC,
  
  CB061_DS_FORMAT
  
  
  FROM CB280 AS CB280
  
LEFT OUTER JOIN CB250 AS CB250  -- BANCO
ON     CB250_NR_OPERADOR = CB280_NR_OPERADOR
   AND CB250_NR_CEDENTE  = CB280_NR_CEDENTE
   AND CB250_CD_COMPSC	 = CB280_CD_COMPSC 

 LEFT OUTER JOIN CB251 AS CB251  -- AGENCIA
ON     CB251_NR_OPERADOR = CB280_NR_OPERADOR
   AND CB251_NR_CEDENTE  = CB280_NR_CEDENTE
   AND CB251_CD_COMPSC	 = CB280_CD_COMPSC 
   AND CB251_NR_AGENC	 = CB280_NR_AGENC   

 LEFT OUTER JOIN CB260 AS CB260  -- CONTA
ON     CB260_NR_OPERADOR  = CB280_NR_OPERADOR
   AND CB260_NR_CEDENTE   = CB280_NR_CEDENTE
   AND CB260_CD_COMPSC	  = CB280_CD_COMPSC 
   AND CB260_NR_AGENC	  = CB280_NR_AGENC
   AND CB260_NR_CONTA	  = CB280_NR_CONTA

  LEFT OUTER JOIN CB270 AS CB270  -- FORMULARIO
ON    CB270_NR_OPERADOR     = CB280.CB280_NR_OPERADOR
  AND CB270_NR_CEDENTE      = CB280.CB280_NR_CEDENTE
  AND CB270.CB270_CD_COMPSC	= CB280.CB280_CD_COMPSC 
  AND CB270.CB270_NR_AGENC	= CB280.CB280_NR_AGENC
  AND CB270.CB270_NR_CONTA	= CB280.CB280_NR_CONTA
  AND CB270.CB270_CD_FORMU	= CB280.CB280_CD_FORMU
  
  LEFT OUTER JOIN CB050 AS CB050  -- INSTITUICAO
  ON  CB050.CB050_NR_INST	= CB280.CB280_NR_INST
  
  LEFT OUTER JOIN CB053 AS CB053  -- EMISSOR/EMPRESA
  ON  CB053.CB053_CD_EMIEMP	= CB280.CB280_CD_EMIEMP
  
  LEFT OUTER JOIN CB060 AS CB060  -- PUBLICACAO
  ON  CB060.CB060_CD_PUBLIC	= CB280.CB280_CD_PUBLIC
  
  LEFT OUTER JOIN CB061 AS CB061  -- FORMATO
  ON  CB061.CB061_DS_FORMAT	= CB280.CB280_CD_FORMAT
  
  	
GO