-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB270]'))
DROP VIEW [dbo].[VW_CB270]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB270]
WITH ENCRYPTION
AS
 SELECT 
  
  CB270.CB270_CD_COMPSC,
  CB270.CB270_NR_AGENC,
  CB270.CB270_NR_CONTA,
  CB270.CB270_CD_FORMU,
  CB270.CB270_DS_FORMU,
  CB270.CB270_ID_MEINSG,
  CASE 
  WHEN CB270.CB270_ID_MEINSG = 0 THEN 'N達o'
  WHEN CB270.CB270_ID_MEINSG = 1 THEN 'Sim'
  END CB270_ID_MEINSG_L,
  CB270.CB270_ID_MEINSF,
  CASE 
  WHEN CB270.CB270_ID_MEINSF = 0 THEN 'N達o'
  WHEN CB270.CB270_ID_MEINSF = 1 THEN 'Sim'
  END CB270_ID_MEINSF_L,
  CB270.CB270_ID_TXTV,
  CASE 
  WHEN CB270.CB270_ID_TXTV = 0 THEN 'N達o'
  WHEN CB270.CB270_ID_TXTV = 1 THEN 'Sim'
  END CB270_ID_TXTV_L,
  CB270.CB270_ID_TXTVS,
  CASE 
  WHEN CB270.CB270_ID_TXTVS = 0 THEN 'N達o'
  WHEN CB270.CB270_ID_TXTVS = 1 THEN 'Sim'
  END CB270_ID_TXTVS_L,
  CB270.CB270_VL_UNITAR,
  CB270.CB270_CD_OPESIS,
  CB270.CB270_DT_INCSIS,
  CB270.CB270_DT_ATUSIS,
  
  -- BANCO
  CB250.CB250_CD_COMPSC,
  CB250.CB250_NM_BANCO,
  
  -- AGENCIA
  CB251.CB251_CD_COMPSC,
  CB251.CB251_NM_AGENC,
  
  -- CONTA
  CB260.CB260_CD_COMPSC,
  CB260.CB260_NR_AGENC,
  CB260.CB260_NM_CEDENT
  
  
  FROM CB270 AS CB270
  
LEFT OUTER JOIN CB250 AS CB250  -- BANCO
ON     CB250_NR_OPERADOR = CB270_NR_OPERADOR
   AND CB250_NR_CEDENTE  = CB270_NR_CEDENTE
   AND CB250_CD_COMPSC	 = CB270_CD_COMPSC 

 LEFT OUTER JOIN CB251 AS CB251  -- AGENCIA
ON     CB251_NR_OPERADOR = CB270_NR_OPERADOR
   AND CB251_NR_CEDENTE  = CB270_NR_CEDENTE
   AND CB251_CD_COMPSC	 = CB270_CD_COMPSC 
   AND CB251_NR_AGENC	 = CB270_NR_AGENC   

 LEFT OUTER JOIN CB260 AS CB260  -- CONTA
ON     CB260_NR_OPERADOR  = CB270_NR_OPERADOR
   AND CB260_NR_CEDENTE   = CB270_NR_CEDENTE
   AND CB260_CD_COMPSC	  = CB270_CD_COMPSC 
   AND CB260_NR_AGENC	  = CB270_NR_AGENC
   AND CB260_NR_CONTA	  = CB270_NR_CONTA

GO