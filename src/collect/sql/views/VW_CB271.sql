-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB271]'))
DROP VIEW [dbo].[VW_CB271]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB271]
WITH ENCRYPTION
AS
 SELECT 
  
  CB271.CB271_CD_COMPSC,
  CB271.CB271_NR_AGENC,
  CB271.CB271_NR_CONTA,
  CB271.CB271_CD_FORMU,
  CB271.CB271_NR_REGRA,
  CB271.CB271_NR_SEQ,
  CB271.CB271_DS_TEXTO,
  CB271.CB271_CD_OPESIS,
  CB271.CB271_DT_INCSIS,
  CB271.CB271_DT_ATUSIS,
  
  -- BANCO
  CB250.CB250_CD_COMPSC,
  CB250.CB250_NM_BANCO,
  
  -- AGENCIA
  CB251.CB251_CD_COMPSC,
  CB251.CB251_NM_AGENC,
  
  -- CONTA
  CB260.CB260_CD_COMPSC,
  CB260.CB260_NR_AGENC,
  CB260.CB260_NM_CEDENT,
  
  -- FORMUL√ÅRIO
  CB270.CB270_CD_COMPSC,
  CB270.CB270_NR_AGENC,
  CB270.CB270_NR_CONTA,
  CB270.CB270_CD_FORMU,
  CB270.CB270_DS_FORMU
  
  
  FROM CB271 AS CB271
  
LEFT OUTER JOIN CB250 AS CB250  -- BANCO
ON     CB250_NR_OPERADOR = CB271_NR_OPERADOR
   AND CB250_NR_CEDENTE  = CB271_NR_CEDENTE
   AND CB250_CD_COMPSC	 = CB271_CD_COMPSC 

 LEFT OUTER JOIN CB251 AS CB251  -- AGENCIA
ON     CB251_NR_OPERADOR = CB271_NR_OPERADOR
   AND CB251_NR_CEDENTE  = CB271_NR_CEDENTE
   AND CB251_CD_COMPSC	 = CB271_CD_COMPSC 
   AND CB251_NR_AGENC	 = CB271_NR_AGENC   

 LEFT OUTER JOIN CB260 AS CB260  -- CONTA
ON     CB260_NR_OPERADOR  = CB271_NR_OPERADOR
   AND CB260_NR_CEDENTE   = CB271_NR_CEDENTE
   AND CB260_CD_COMPSC	  = CB271_CD_COMPSC 
   AND CB260_NR_AGENC	  = CB271_NR_AGENC
   AND CB260_NR_CONTA	  = CB271_NR_CONTA

  LEFT OUTER JOIN CB270 AS CB270  -- CONTA
ON    CB270_NR_OPERADOR     = CB271.CB271_NR_OPERADOR
  AND CB270_NR_CEDENTE      = CB271.CB271_NR_CEDENTE
  AND CB270.CB270_CD_COMPSC	= CB271.CB271_CD_COMPSC 
  AND CB270.CB270_NR_AGENC	= CB271.CB271_NR_AGENC
  AND CB270.CB270_NR_CONTA	= CB271.CB271_NR_CONTA
  AND CB270.CB270_CD_FORMU	= CB271.CB271_CD_FORMU
	
GO