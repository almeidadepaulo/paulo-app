-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_CB043]'))
DROP VIEW [dbo].[VW_CB043]
GO

-- Cria View
CREATE VIEW [dbo].[VW_CB043]
WITH ENCRYPTION
AS
  SELECT
    CB043.CB043_CD_LOCALI,
  	CB043.CB043_CD_BAIRRO,
  	CB043.CB043_CD_REGIAO,
  	CB043.CB043_CD_ESTBR,
  	CB043.CB043_NM_REGIAO,
  	CB043.CB043_NM_REGIAR,
  	CB043.CB043_CD_OPESIS,
  	CB043.CB043_DT_INCSIS,
  	CB043.CB043_DT_ATUSIS,
  
    CB041.CB041_NM_LOCALI,
    
    CB042.CB042_NM_BAIRR
    
  FROM CB043 AS CB043
  
  LEFT OUTER JOIN CB042 AS CB042
  ON CB043.CB043_CD_LOCALI = CB042.CB042_CD_LOCALI
  AND CB043.CB043_CD_BAIRRO = CB042.CB042_CD_BAIRRO
  
  LEFT OUTER JOIN CB041 AS CB041
  ON CB043.CB043_CD_LOCALI = CB041.CB041_CD_LOCALI -- Teste

GO