-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BKN506]'))
DROP VIEW [dbo].[VW_BKN506]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BKN506]
WITH ENCRYPTION
AS

  SELECT 
  
  BKN506.BKN506_NR_BANCO,
  BKN506.BKN506_NR_CESS,
  BKN506.BKN506_NR_LANC,
  BKN506.BKN506_NR_CONT,
  BKN506.BKN506_VL_LANC,
  BKN506.BKN506_TP_SINAL,
  BKN506.BKN506_DT_LANC,
  BKN506.BKN506_NR_TPLANC,
  BKN506.BKN506_NM_COMPL,
  BKN506.BKN506_NR_OPESIS,
  BKN506.BKN506_DT_INCSIS,
  BKN506.BKN506_DT_ATUSIS,
  
  
  '?' AS BKN002_NR_BANCO,
  '?' AS BKN002_NR_CESS,
  '?' AS BKN002_NR_CNPJ,
  '?' AS BKN002_NM_CESS,
  '?' AS BKN002_NR_OPESIS,
  '?' AS BKN002_DT_INCSIS,
  '?' AS BKN002_DT_ATUSIS,
  
  BKN505.BKN505_NR_BANCO,
  BKN505.BKN505_NR_TPLANC,
  BKN505.BKN505_NM_TPLANC,
  BKN505.BKN505_TP_FINANC,
  BKN505.BKN505_TP_SINAL,
  BKN505.BKN505_NR_OPESIS,
  BKN505.BKN505_DT_INCSIS,
  BKN505.BKN505_DT_ATUSIS,
  
  BKN505.BKN505_NR_PROD
  
   
   FROM BKN506 AS BKN506
   
   /*
   INNER JOIN BKN002 AS BKN002
   ON  BKN506.BKN506_NR_BANCO = BKN002.BKN002_NR_BANCO
   AND BKN506.BKN506_NR_CESS  = BKN002.BKN002_NR_CESS
   */
   
   LEFT OUTER JOIN BKN505 AS BKN505
   ON  BKN506.BKN506_NR_BANCO = BKN505.BKN505_NR_BANCO
   AND BKN506.BKN506_NR_TPLANC  = BKN505.BKN505_NR_TPLANC


GO


