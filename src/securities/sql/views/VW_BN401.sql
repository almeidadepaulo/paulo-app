-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN401]'))
DROP VIEW [dbo].[VW_BN401]
GO

-- Tela Geral de Garania
-- Cria View
CREATE VIEW [dbo].[VW_BN401]
WITH ENCRYPTION
AS
SELECT 
  BN401.BN401_NR_GRUPO,
  BN401.BN401_NR_INST,
  BN401.BN401_DT_MOVTO,
  BN401.BN401_NR_PROD,
  BN401.BN401_TT_GAR,
  BN401.BN401_TT_PRES,
  BN401.BN401_TT_EXIG,
  BN401.BN401_TT_VENC,
  BN401.BN401_NR_OPESIS,
  BN401.BN401_DT_INCSIS,
  BN401.BN401_DT_ATUSIS,
  
-- INSTITUICAO
  BN002.BN002_NR_GRUPO,
  BN002.BN002_NR_INST,
  BN002.BN002_NM_INST,
  
-- PRODUTO  
  BN004.BN004_NR_PROD,
  BN004.BN004_NM_PROD  
      
FROM 
  BN401 as BN401
  
  INNER JOIN BN002 AS BN002
  ON 	BN002.BN002_NR_GRUPO 	= BN401.BN401_NR_GRUPO
  AND 	BN002.BN002_NR_INST 	= BN401.BN401_NR_INST

  LEFT  JOIN  BN004 AS BN004
  ON BN004.BN004_NR_PROD = BN401.BN401_NR_PROD

GO


