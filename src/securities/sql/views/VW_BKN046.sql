-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BKN046]'))
DROP VIEW [dbo].[VW_BKN046]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BKN046]
WITH ENCRYPTION
AS

  SELECT 
  
	BKN046.BKN046_NR_BANCO,
	BKN046.BKN046_NR_CESS,
	BKN046.BKN046_NR_CNPJ,
	BKN046.BKN046_NM_CESS,
	BKN046.BKN046_NR_CBANCO,
	BKN046.BKN046_NR_CAGENC,
	BKN046.BKN046_NR_CCONTA,
	BKN046.BKN046_NR_OPESIS,
	BKN046.BKN046_DT_INCSIS,
	BKN046.BKN046_DT_ATUSIS,
  
	VW_BKN001.BKN001_NR_BANCO,
	VW_BKN001.BKN001_NR_CNPJ,
	VW_BKN001.BKN001_NM_BANCO,
	VW_BKN001.BKN001_NR_OPESIS,
	VW_BKN001.BKN001_DT_INCSIS,
	VW_BKN001.BKN001_DT_ATUSIS,
	VW_BKN001.BKN001_NR_NM_BANCO,
  
  Cast(BKN046.BKN046_NR_CESS as varchar)+' - '+BKN046.BKN046_NM_CESS as BKN046_NR_NM_CESS
  
  
  FROM BKN046 AS BKN046
  LEFT OUTER JOIN VW_BKN001 AS VW_BKN001
  ON BKN046.BKN046_NR_BANCO = VW_BKN001.BKN001_NR_BANCO

GO


