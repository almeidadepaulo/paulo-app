-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BKN507]'))
DROP VIEW [dbo].[VW_BKN507]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BKN507]
WITH ENCRYPTION
AS

  SELECT 
  
  BKN507.BKN507_NR_BANCO,
  BKN507.BKN507_NR_ENT,
  BKN507.BKN507_NR_LANC,
  BKN507.BKN507_NR_CONT,
  BKN507.BKN507_VL_LANC,
  BKN507.BKN507_TP_SINAL,
  BKN507.BKN507_DT_LANC,
  BKN507.BKN507_NM_COMPL,
  BKN507.BKN507_NR_TPLANC,
  BKN507.BKN507_NR_OPESIS,
  BKN507.BKN507_DT_INCSIS,
  BKN507.BKN507_DT_ATUSIS,
  
  BKN003.BKN003_NR_BANCO,
  BKN003.BKN003_NR_ENT,
  BKN003.BKN003_NM_ENT,
  BKN003.BKN003_NR_CNPJ,
  BKN003.BKN003_TP_TARIFA,
  BKN003.BKN003_PC_TARIFA,
  BKN003.BKN003_VL_TARIFA,
  BKN003.BKN003_VL_DOC,
  BKN003.BKN003_TP_PREV,
  BKN003.BKN003_NM_EMAIL,
  BKN003.BKN003_NM_PORTAL,
  BKN003.BKN003_TP_LOTA,
  BKN003.BKN003_TP_VAN,
  BKN003.BKN003_TP_BLOCON,
  BKN003.BKN003_NR_OPESIS,
  BKN003.BKN003_DT_INCSIS,
  BKN003.BKN003_DT_ATUSIS,
    
  
  BKN505.BKN505_NR_BANCO,
  BKN505.BKN505_NR_TPLANC,
  BKN505.BKN505_NM_TPLANC,
  BKN505.BKN505_TP_FINANC,
  BKN505.BKN505_TP_SINAL,
  BKN505.BKN505_NR_OPESIS,
  BKN505.BKN505_DT_INCSIS,
  BKN505.BKN505_DT_ATUSIS,
  
  BKN505.BKN505_NR_PROD
  
   
   FROM BKN507 AS BKN507
   
   INNER JOIN BKN003 AS BKN003
   ON  BKN003.BKN003_NR_BANCO	= 	BKN507.BKN507_NR_BANCO
   AND BKN003.BKN003_NR_ENT		= 	BKN507.BKN507_NR_ENT
   
   LEFT OUTER JOIN BKN505 AS BKN505
   ON  BKN505.BKN505_NR_BANCO	=	BKN507.BKN507_NR_BANCO 
   AND BKN505.BKN505_NR_TPLANC	=	BKN507.BKN507_NR_TPLANC


GO


