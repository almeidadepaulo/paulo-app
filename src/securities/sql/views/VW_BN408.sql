-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN408]'))
DROP VIEW [dbo].[VW_BN408]
GO

-- Tela Relatório Diário Bacen
-- Cria View
CREATE VIEW [dbo].[VW_BN408]
WITH ENCRYPTION
AS
  SELECT 
  BN408.BN408_NR_GRUPO,
  BN408.BN408_NR_INST,
  BN408.BN408_DT_MOVTO,
  BN408.BN408_VL_LIMCON,
  BN408.BN408_ST_LIM,
  BN408.BN408_TT_GAR,
  BN408.BN408_TT_PRES,
  BN408.BN408_TT_EXIG,
  BN408.BN408_TT_CAP,
  BN408.BN408_NR_OPESIS,
  BN408.BN408_DT_INCSIS,
  BN408.BN408_DT_ATUSIS,
  
  BN002.BN002_NR_INST,
  BN002.BN002_NM_INST,
  BN002.BN002_NR_CNPJ,
  CAST(BN002_NR_INST AS VARCHAR)+' - '+BN002.BN002_NM_INST as BN002_NR_NM_INST,
  
  'J' AS BN002_TP_CPFCNPJ,
  
  BN001.BN001_NR_GRUPO,
  BN001.BN001_NM_GRUPO,
  Cast(BN001.BN001_NR_GRUPO as varchar)+' - '+BN001.BN001_NM_GRUPO AS BN001_NR_NM_GRUPO
  
	
FROM 
  dbo.BN408 as BN408
  
  LEFT JOIN BN002 AS BN002
  ON  BN408.BN408_NR_GRUPO = BN002.BN002_NR_GRUPO
  AND BN408.BN408_NR_INST  = BN002.BN002_NR_INST
  

  LEFT JOIN BN001 AS BN001
  ON BN408.BN408_NR_GRUPO = BN001.BN001_NR_GRUPO

GO


