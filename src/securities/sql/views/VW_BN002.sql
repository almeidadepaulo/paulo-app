-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN002]'))
DROP VIEW [dbo].[VW_BN002]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BN002]
WITH ENCRYPTION
AS
  SELECT 
    BN002.BN002_NR_GRUPO,
    BN002.BN002_NR_INST,
    BN002.BN002_NR_CNPJ,
    BN002.BN002_NM_INST,
    BN002.BN002_NR_OPESIS,
    BN002.BN002_DT_INCSIS,
    BN002.BN002_DT_ATUSIS,
    BN002.BN002_NM_BAIRRO,
    BN002.BN002_NM_CIDADE,
    BN002.BN002_NM_COMPL,
    BN002.BN002_NM_END,
    BN002.BN002_NM_ESTADO,
    BN002.BN002_NR_CEP,
    BN002.BN002_NR_DDD,
    BN002.BN002_NR_END,
    BN002.BN002_NR_TEL,
    
    BN002.BN002_NR_GRUPO AS gru_id,
    BN002.BN002_NR_INST AS ins_id,
  
    VW_BN001.BN001_NR_GRUPO,
    VW_BN001.BN001_NR_CNPJ,
    VW_BN001.BN001_NM_GRUPO,
    VW_BN001.BN001_NR_OPESIS,
    VW_BN001.BN001_DT_INCSIS,
    VW_BN001.BN001_DT_ATUSIS,
    VW_BN001.BN001_NR_NM_GRUPO,

	VW_BN001.BN001_NR_NM_GRUPO AS CB050_NR_NM_INST

  FROM BN002 AS BN002
  LEFT OUTER JOIN VW_BN001 AS VW_BN001
  ON BN002.BN002_NR_GRUPO = VW_BN001.BN001_NR_GRUPO -- Teste

GO


