-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN021]'))
DROP VIEW [dbo].[VW_BN021]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BN021]
WITH ENCRYPTION
AS
  SELECT 
	BN021.BN021_NR_PROD,
	BN021.BN021_NR_SECAO,
	BN021.BN021_NR_DIV,
	BN021.BN021_NR_GRUPO,
	BN021.BN021_NR_CLASSE,
	BN021.BN021_NR_SUBCLA,
	
	BN017.BN017_NR_SECAO,
	BN017.BN017_NR_DIV,
	BN017.BN017_NR_GRUPO,
	BN017.BN017_NR_CLASSE,
	BN017.BN017_NR_SUBCLA,
	BN017.BN017_NM_CNAE,
	BN017.BN017_NR_OPESIS,
	BN017.BN017_DT_INCSIS,
	BN017.BN017_DT_ATUSIS
	


  FROM BN021 AS BN021
  
  INNER JOIN BN017 AS BN017
  ON	BN021.BN021_NR_SECAO	= BN017.BN017_NR_SECAO
  AND	BN021.BN021_NR_DIV		= BN017.BN017_NR_DIV
  AND	BN021.BN021_NR_GRUPO	= BN017.BN017_NR_GRUPO
  AND	BN021.BN021_NR_CLASSE	= BN017.BN017_NR_CLASSE
  AND	BN021.BN021_NR_SUBCLA	= BN017.BN017_NR_SUBCLA
 
  
GO
