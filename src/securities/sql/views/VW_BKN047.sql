-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BKN047]'))
DROP VIEW [dbo].[VW_BKN047]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BKN047]
WITH ENCRYPTION
AS

  SELECT 
  
	BKN047.BKN047_NR_CESS,
	BKN047.BKN047_NR_PROD,
	BKN047.BKN047_NR_PRZMAX,
	BKN047.BKN047_NR_IDAMIN,
	BKN047.BKN047_NR_IDAMAX,
	BKN047.BKN047_TX_FINMIN,
	BKN047.BKN047_TX_FINMAX,
	BKN047.BKN047_VL_MINCON,
	BKN047.BKN047_NR_OPESIS,
	BKN047.BKN047_DT_INCSIS,
	BKN047.BKN047_DT_ATUSIS,

	VW_BN001.BN001_NM_GRUPO,

	BN004.BN004_NR_PROD,
	BN004.BN004_NM_PROD,
	BN004.BN004_TP_PROD
  
   
  FROM BKN047 AS BKN047

  INNER JOIN VW_BN001 AS VW_BN001
  ON BKN047.BKN047_NR_CESS = VW_BN001.BN001_NR_GRUPO

  INNER JOIN BN004 AS BN004
  ON BKN047.BKN047_NR_PROD = BN004.BN004_NR_PROD

GO


