-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN208]'))
DROP VIEW [dbo].[VW_BN208]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BN208]
WITH ENCRYPTION
AS
  
  SELECT 
  
	BN208.BN208_NR_GRUPO
	,BN208.BN208_NR_INST
	,BN208.BN208_NR_FAIXA
	,BN208.BN208_TT_LIMCON36
	,BN208.BN208_TT_LIMCON24
	,BN208.BN208_TT_LIMCON
	,BN208.BN208_TT_DPGEFS1
	,BN208.BN208_TT_DPGEFS2
	,BN208.BN208_TT_LIMDSP
	,BN208.BN208_TT_SDFAIXA
	,BN208.BN208_TT_AUXILIAR
	,BN208.BN208_TT_AJUSTE
	
	,VW_BN407_CL.TT_EXIGIDO -- LIMITE CONCEDIDO (Soma das garantias com exigibilidade)
	

	FROM BN208 AS BN208
	
	
	INNER JOIN VW_BN407_CL AS VW_BN407_CL -- Para facilitar no cálculos (Saldo por Faixa, Auxiliar, Ajuste), sendo necessário apensa um SELECT.
	ON	VW_BN407_CL.BN001_NR_GRUPO	= BN208.BN208_NR_GRUPO
	AND VW_BN407_CL.BN002_NR_INST	= BN208.BN208_NR_INST		
	
	
GO

/*Exemplo*/
SELECT	TOP 10 *
FROM	VW_BN208

