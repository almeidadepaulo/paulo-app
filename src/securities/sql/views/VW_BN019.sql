-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_BN019]'))
DROP VIEW [dbo].[VW_BN019]
GO

-- Cria View
CREATE VIEW [dbo].[VW_BN019]
WITH ENCRYPTION
AS
  SELECT 
	BN019.BN019_NR_GRUPO
	,BN019.BN019_NR_INST
	,BN019.BN019_NR_REME	
	,BN019.BN019_NR_STATUS
	,BN019.BN019_NR_STATUSP
	,BN019.BN019_DT_INICIO
	,BN019.BN019_HR_INICIO
	,BN019.BN019_DT_FIM
	,BN019.BN019_HR_FIM
	,BN019.BN019_NR_OPESIS
	,BN019.BN019_DT_INCSIS
	,BN019.BN019_DT_ATUSIS
	
	,BN200.BN200_NR_CNPJ
	,BN200.BN200_ST_EMPRESA
	,BN200.BN200_QT_TTCONTRA
	,BN200.BN200_QT_QTDEIF   
	,BN200.BN200_LT_RATCALCBC 
	
	/*
	,BN002.BN002_NR_GRUPO
	,BN002.BN002_NR_INST
	*/
  FROM BN019 AS BN019
 
 
  INNER JOIN BN200 AS BN200
  ON	BN019_NR_GRUPO	=	BN200.BN200_NR_GRUPO
  AND	BN019_NR_INST	=	BN200.BN200_NR_INST
  --AND	BN002_NR_CNPJ	=	BN200.BN200_NR_CNPJ
  AND	BN019_NR_REME	=	BN200.BN200_NR_REME 
  /**/
  /*
  INNER JOIN BN002 AS BN002
  --ON BN200.BN200_NR_GRUPO = BN002.BN002_NR_GRUPO
  --AND BN200.BN200_NR_INST = BN002.BN002_NR_INST   
  ON BN200.BN200_NR_CNPJ = BN002.BN002_NR_CNPJ
  */
  /**/
GO
