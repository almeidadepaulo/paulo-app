-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_MG071]'))
DROP VIEW [dbo].[VW_MG071]
GO

-- Cria View da tela SMS - Configurações -  Pacote x Cód. SMS
CREATE VIEW [dbo].[VW_MG071]
WITH ENCRYPTION
AS
SELECT
  MG071.MG071_NR_PACOTE,
  MG071.MG071_CD_CODSMS,
  MG071.MG071_NR_SEQ,
  MG071.MG071_CD_OPESIS,
  MG071.MG071_DT_ATUSIS,
  MG071.MG071_DT_INCSIS,
-- COD.SMS
  VW_MG055.MG055_DS_CODSMS,
  VW_MG055.MG055_NR_INST,
  VW_MG055.MG055_CD_EMIEMP,
-- PACOTE
  MG070.MG070_NM_PACOTE
FROM  
  MG071 AS MG071
-- COD. SMS
INNER JOIN VW_MG055 AS VW_MG055
ON VW_MG055.MG055_CD_CODSMS = MG071.MG071_CD_CODSMS
-- PACOTE
INNER JOIN MG070 AS MG070
ON  MG070.MG070_NR_PACOTE = MG071.MG071_NR_PACOTE
AND MG070.MG070_NR_OPERADOR = VW_MG055.MG055_NR_INST
GO 

