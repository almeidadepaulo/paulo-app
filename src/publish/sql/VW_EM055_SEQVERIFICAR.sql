-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_EM055_SEQ]'))
DROP VIEW [dbo].[VW_EM055_SEQ]
GO

-- Criar View da tela - EMAIL - Configurações -  Prioridade
CREATE VIEW [dbo].[VW_EM055_SEQ]
WITH ENCRYPTION
AS

SELECT
	EM055_NR_INST,
	EM055_CD_EMIEMP,
	EM055_CD_CODEMAIL,
	EM055_DS_CODEMAIL,
	EM055_ID_ATIVO,
	EM055_TP_CATEG,
	EM055_CD_OPESIS,
	EM055_DT_INCSIS,
	EM055_DT_ATUSIS,

	EM057_NR_INST,
	EM057_CD_EMIEMP,
	EM057_CD_CODEMAIL,
	-- ROW_NUMBER() OVER (Order by EM057_NR_SEQ) AS ROW_NUMBER
	EM057_NR_SEQ,
	ISNULL(EM057_NR_SEQ, ROW_NUMBER() OVER (ORDER BY EM057_NR_SEQ)) AS NR_SEQ,
	EM057_CD_OPESIS,
	EM057_DT_INCSIS,
	EM057_DT_ATUSIS
FROM
  EM055

LEFT OUTER JOIN EM057
ON  EM057_NR_INST = EM057_NR_INST
AND EM055_CD_EMIEMP = EM057_CD_EMIEMP
AND EM055_CD_CODEMAIL = EM057_CD_CODEMAIL

GO
