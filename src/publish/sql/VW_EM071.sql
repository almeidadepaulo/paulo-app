-- Configura View
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

-- Apaga view
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VW_EM071]'))
DROP VIEW [dbo].[VW_EM071]
GO

-- Cria View da tela EMAIL - Configurações -  Pacote x Cód. EMAIL
CREATE VIEW [dbo].[VW_EM071]
WITH ENCRYPTION
AS
SELECT
  EM071.EM071_NR_PACOTE,
  EM071.EM071_CD_CODEMAIL,
  EM071.EM071_NR_SEQ,
  EM071.EM071_CD_OPESIS,
  EM071.EM071_DT_ATUSIS,
  EM071.EM071_DT_INCSIS,
-- COD.EMAIL
  VW_EM055.EM055_DS_CODEMAIL,
  VW_EM055.EM055_NR_INST,
  VW_EM055.EM055_CD_EMIEMP,
-- PACOTE
  EM070.EM070_NM_PACOTE
FROM  
  EM071 AS EM071
-- COD. EMAIL
INNER JOIN VW_EM055 AS VW_EM055
ON VW_EM055.EM055_CD_CODEMAIL = EM071.EM071_CD_CODEMAIL
-- PACOTE
INNER JOIN EM070 AS EM070
ON  EM070.EM070_NR_PACOTE = EM071.EM071_NR_PACOTE
AND EM070.EM070_NR_INST = VW_EM055.EM055_NR_INST
GO 

